<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="https://igv.org/web/img/favicon.ico">

    <title>IGV Variant Inspector </title>

    <!-- igv -->
    <script type="text/javascript" src="http://localhost/igv-web/dist/igv.js"></script>


    <!-- selector table style -->
    <style>
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        tr:hover {
            background-color: lightblue;
        }

        th {
            background-color: lightskyblue;
            color: white;
        }
    </style>

    <style type="text/css">
        body {
            font-size: 80%;
            font-family: 'Lucida Grande', Verdana, Arial, Sans-Serif;
        }

        ul#tabs {
            list-style-type: none;
            margin: 30px 0 0 0;
            padding: 0 0 0.3em 0;
        }

        ul#tabs li {
            display: inline;
        }

        ul#tabs li a {
            color: #42454a;
            background-color: #dedbde;
            border: 1px solid #c9c3ba;
            border-bottom: none;
            padding: 0.3em;
            text-decoration: none;
        }

        ul#tabs li a:hover {
            background-color: #f1f0ee;
        }

        ul#tabs li a.selected {
            color: #000;
            background-color: #f1f0ee;
            font-weight: bold;
            padding: 0.7em 0.3em 0.38em 0.3em;
        }

        div.tabContent {
            border: 1px solid #c9c3ba;
            padding: 0.5em;
        }

        div.tabContent.hide {
            display: none;
        }
    </style>

</head>

<body>


<ul id="tabs">
    <li><a href="#firstTab">Variant Table</a></li>
    <li><a href="#igvTab">IGV View</a></li>
</ul>

<div id="firstTab">
    <div id="tableSelectorDiv" style="overflow: auto"></div>
</div>

<div id="igvTab">
    <div id="igvDiv"></div>
</div>


<script type="text/javascript">

    var tableJson = [
        {
            "ALT": "G",
            "CHASM_FDR": "0.3",
            "CHASM_PVALUE": "0.1114",
            "CHROM": "chr5",
            "COSMIC_ID": "COSM4006021",
            "DP": "4",
            "GENE": "LOC100288152,SLC9A3",
            "KGPROD": "NA",
            "MQ": "60",
            "NSF": "NA",
            "NSM": "NA",
            "NSN": "NA",
            "PMC": "NA",
            "POS": "474989",
            "QUAL": "96.03",
            "REF": "A",
            "RS": "NA",
            "SAO": "NA",
            "TISSUE": "urinary_tract",
            "TUMOR": "carcinoma_--_NS",
            "VEST_FDR": "1",
            "VEST_PVALUE": "0.96802"
        },
        {
            "ALT": "A",
            "CHASM_FDR": "0.3",
            "CHASM_PVALUE": "0.0694",
            "CHROM": "chr5",
            "COSMIC_ID": "NA",
            "DP": "45",
            "GENE": "TRIM41",
            "KGPROD": "NA",
            "MQ": "60",
            "NSF": "NA",
            "NSM": "NA",
            "NSN": "NA",
            "PMC": "NA",
            "POS": "181224474",
            "QUAL": "375.77",
            "REF": "G",
            "RS": "NA",
            "SAO": "NA",
            "TISSUE": "NA",
            "TUMOR": "NA",
            "VEST_FDR": "1",
            "VEST_PVALUE": "0.48052"
        },
        {
            "ALT": "A",
            "CHASM_FDR": "0.2",
            "CHASM_PVALUE": "0.0344",
            "CHROM": "chr8",
            "COSMIC_ID": "COSM3750086",
            "DP": "66",
            "GENE": "PLEC",
            "KGPROD": "NA",
            "MQ": "60",
            "NSF": "NA",
            "NSM": "NA",
            "NSN": "NA",
            "PMC": "NA",
            "POS": "143923759",
            "QUAL": "878.77",
            "REF": "G",
            "RS": "NA",
            "SAO": "NA",
            "TISSUE": "large_intestine",
            "TUMOR": "carcinoma_--_adenocarcinoma",
            "VEST_FDR": "1",
            "VEST_PVALUE": "0.84202"
        },
        {
            "ALT": "A",
            "CHASM_FDR": "0.3",
            "CHASM_PVALUE": "0.0744",
            "CHROM": "chr12",
            "COSMIC_ID": "COSM3753397",
            "DP": "48",
            "GENE": "TIMELESS",
            "KGPROD": "NA",
            "MQ": "60",
            "NSF": "NA",
            "NSM": "NA",
            "NSN": "NA",
            "PMC": "NA",
            "POS": "56420869",
            "QUAL": "392.77",
            "REF": "G",
            "RS": "NA",
            "SAO": "NA",
            "TISSUE": "large_intestine",
            "TUMOR": "carcinoma_--_adenocarcinoma",
            "VEST_FDR": "1",
            "VEST_PVALUE": "0.18439"
        },
        {
            "ALT": "T",
            "CHASM_FDR": "0.05",
            "CHASM_PVALUE": "0",
            "CHROM": "chr17",
            "COSMIC_ID": "COSM3717625",
            "DP": "61",
            "GENE": "TP53",
            "KGPROD": "NA",
            "MQ": "60",
            "NSF": "NA",
            "NSM": "NA",
            "NSN": "NA",
            "PMC": "NA",
            "POS": "7673767",
            "QUAL": "2000.77",
            "REF": "C",
            "RS": "NA",
            "SAO": "NA",
            "TISSUE": "bone",
            "TUMOR": "Ewings_sarcoma-peripheral_primitive_neuroectodermal_tumour_--_NS",
            "VEST_FDR": "0.3",
            "VEST_PVALUE": "0.01447"
        },
        {
            "ALT": "C",
            "CHASM_FDR": "0.3",
            "CHASM_PVALUE": "0.087",
            "CHROM": "chr17",
            "COSMIC_ID": "COSM3766193",
            "DP": "80",
            "GENE": "TP53",
            "KGPROD": "NA",
            "MQ": "60",
            "NSF": "NA",
            "NSM": "NA",
            "NSN": "NA",
            "PMC": "NA",
            "POS": "7676154",
            "QUAL": "2150.77",
            "REF": "G",
            "RS": "NA",
            "SAO": "NA",
            "TISSUE": "haematopoietic_and_lymphoid_tissue",
            "TUMOR": "haematopoietic_neoplasm_--_acute_myeloid_leukaemia",
            "VEST_FDR": "1",
            "VEST_PVALUE": "0.52717"
        },
        {
            "ALT": "C",
            "CHASM_FDR": "0.2",
            "CHASM_PVALUE": "0.0372",
            "CHROM": "chr17",
            "COSMIC_ID": "COSM3755560",
            "DP": "4",
            "GENE": "BRCA1",
            "KGPROD": "NA",
            "MQ": "60",
            "NSF": "NA",
            "NSM": "NA",
            "NSN": "NA",
            "PMC": "NA",
            "POS": "43071077",
            "QUAL": "97.03",
            "REF": "T",
            "RS": "NA",
            "SAO": "NA",
            "TISSUE": "haematopoietic_and_lymphoid_tissue",
            "TUMOR": "haematopoietic_neoplasm_--_acute_myeloid_leukaemia",
            "VEST_FDR": "1",
            "VEST_PVALUE": "0.3446"
        },
        {
            "ALT": "C",
            "CHASM_FDR": "0.05",
            "CHASM_PVALUE": "0.0002",
            "CHROM": "chr17",
            "COSMIC_ID": "COSM3755561",
            "DP": "4",
            "GENE": "BRCA1",
            "KGPROD": "NA",
            "MQ": "60",
            "NSF": "NA",
            "NSM": "NA",
            "NSN": "NA",
            "PMC": "NA",
            "POS": "43091983",
            "QUAL": "89.03",
            "REF": "T",
            "RS": "NA",
            "SAO": "NA",
            "TISSUE": "soft_tissue",
            "TUMOR": "haemangioblastoma_--_NS",
            "VEST_FDR": "1",
            "VEST_PVALUE": "0.64447"
        },
        {
            "ALT": "A",
            "CHASM_FDR": "0.05",
            "CHASM_PVALUE": "0.0004",
            "CHROM": "chr17",
            "COSMIC_ID": "COSM3755564",
            "DP": "2",
            "GENE": "BRCA1",
            "KGPROD": "NA",
            "MQ": "60",
            "NSF": "NA",
            "NSM": "NA",
            "NSN": "NA",
            "PMC": "NA",
            "POS": "43092919",
            "QUAL": "39.74",
            "REF": "G",
            "RS": "NA",
            "SAO": "NA",
            "TISSUE": "prostate",
            "TUMOR": "carcinoma_--_NS",
            "VEST_FDR": "1",
            "VEST_PVALUE": "0.33539"
        },
        {
            "ALT": "T",
            "CHASM_FDR": "0.05",
            "CHASM_PVALUE": "0.0014",
            "CHROM": "chr17",
            "COSMIC_ID": "COSM4989394",
            "DP": "11",
            "GENE": "BRCA1",
            "KGPROD": "NA",
            "MQ": "60",
            "NSF": "NA",
            "NSM": "NA",
            "NSN": "NA",
            "PMC": "NA",
            "POS": "43093454",
            "QUAL": "425.77",
            "REF": "C",
            "RS": "NA",
            "SAO": "NA",
            "TISSUE": "soft_tissue",
            "TUMOR": "rhabdomyosarcoma_--_embryonal",
            "VEST_FDR": "1",
            "VEST_PVALUE": "0.51068"
        },
        {
            "ALT": "C",
            "CHASM_FDR": "0.05",
            "CHASM_PVALUE": "0.0004",
            "CHROM": "chr19",
            "COSMIC_ID": "NA",
            "DP": "107",
            "GENE": "PAK4",
            "KGPROD": "NA",
            "MQ": "60",
            "NSF": "NA",
            "NSM": "NA",
            "NSN": "NA",
            "PMC": "NA",
            "POS": "39177761",
            "QUAL": "1232.77",
            "REF": "G",
            "RS": "NA",
            "SAO": "NA",
            "TISSUE": "NA",
            "TUMOR": "NA",
            "VEST_FDR": "0.3",
            "VEST_PVALUE": "0.01093"
        },
        {
            "ALT": "C",
            "CHASM_FDR": "0.3",
            "CHASM_PVALUE": "0.093",
            "CHROM": "chr19",
            "COSMIC_ID": "COSM3721172",
            "DP": "12",
            "GENE": "CCDC9",
            "KGPROD": "NA",
            "MQ": "60",
            "NSF": "NA",
            "NSM": "NA",
            "NSN": "NA",
            "PMC": "NA",
            "POS": "47271515",
            "QUAL": "321.77",
            "REF": "T",
            "RS": "NA",
            "SAO": "NA",
            "TISSUE": "haematopoietic_and_lymphoid_tissue",
            "TUMOR": "haematopoietic_neoplasm_--_acute_myeloid_leukaemia",
            "VEST_FDR": "1",
            "VEST_PVALUE": "0.97622"
        },
        {
            "ALT": "T",
            "CHASM_FDR": "0.3",
            "CHASM_PVALUE": "0.0834",
            "CHROM": "chr20",
            "COSMIC_ID": "COSM3758608",
            "DP": "26",
            "GENE": "TP53RK",
            "KGPROD": "NA",
            "MQ": "60",
            "NSF": "NA",
            "NSM": "NA",
            "NSN": "NA",
            "PMC": "NA",
            "POS": "46687147",
            "QUAL": "453.77",
            "REF": "C",
            "RS": "NA",
            "SAO": "NA",
            "TISSUE": "pancreas",
            "TUMOR": "carcinoma_--_ductal_carcinoma",
            "VEST_FDR": "1",
            "VEST_PVALUE": "0.88584"
        }
    ]


    document.addEventListener("DOMContentLoaded", function () {

        initTabs();

        initIGV();

        initTable();


    });


    function initTabs() {

        var tabs = [];

        // Grab the tab links and content divs from the page
        var liItems = Array.from(document.getElementById('tabs').childNodes).filter(function (item) {
            return item.nodeName === 'LI'
        });

        var tabLinks = liItems.map(function (li) {
            return getFirstChildWithTagName(li, 'A');
        })

        tabLinks.forEach(function (tabLink) {
            tabLink.onclick = showTab;
            tabLink.onfocus = function () {
                this.blur()
            };
            var id = getHash(tabLink.getAttribute('href'));
            var contentDiv = document.getElementById(id);
            tabs.push({
                id: id,
                link: tabLink,
                content: contentDiv
            });
        })

        tabs[0].content.className = 'tabContent';
        tabs[0].link.className = 'selected';
        for (var i = 1; i < tabs.length; i++) {
            tabs[i].link.className = '';
            tabs[i].content.className = 'tabContent hide'
        }

        function showTab() {

            var selectedId = getHash(this.getAttribute('href'));

            tabs.forEach(function (tab) {

                if (tab.id == selectedId) {
                    tab.link.className = 'selected';
                    tab.content.className = 'tabContent';
                } else {
                    tab.link.className = '';
                    tab.content.className = 'tabContent hide';
                }
            });

            igv.visibilityChange();

            // Stop the browser following the link
            return false;
        }


        function getFirstChildWithTagName(element, tagName) {
            for (var i = 0; i < element.childNodes.length; i++) {
                if (element.childNodes[i].nodeName == tagName) return element.childNodes[i];
            }
        }

        function getHash(url) {
            var hashPos = url.lastIndexOf('#');
            return url.substring(hashPos + 1);
        }
    }

    function initIGV() {

        var igvDiv, options;
        igvDiv = document.getElementById("igvDiv");
        options =
            {
                reference: {"fastaURL": "data:application/gzip;base64,H4sIANPl5VsC/71SOW7DMBDs84o8QkHcJPBiCn5gPiCwUGqH/0d2ZkkpdYCYhCxyuZxL/uxfj7fX+/177I/xsb1v2+32gpYjfk3oQbRG+tfrrK0GqKVmFuE6QLe4Q/c5DwROVt/V8Y8ET3XxdxQUDlAL6ADBVjNBeFLNbq2SJ43UUW4oaD3iMZdswtdpXi5ZBgpHIbxwRbenTlpwGLFZsLTV1sJDyKbEEm33WBLDUqogFoPM2K2ZqBhyIFxOkakoKE/nlykoAciOUTnzE3Ng0bWVNspGJeL4JcTuqCzTqmOv01ZpXJXZWH+Ty7p9Sqg8UETeiczqJc0LRlQurS7JkrLhvGI98Evs5eHM0SHaJZS0BJMVufClapmJaDNNuCUCU0sseTl67/txDL/Gka8+vN33Hxi5BuH/AwAA"}


            };
        igv.createBrowser(igvDiv, options);
    }

    function initTable() {
        var table = document.createElement("table");

        table.style.width = "100%";

        document.getElementById("tableSelectorDiv").appendChild(table);

        var thead = document.createElement('thead');
        table.appendChild(thead);
        var headerRow = thead.insertRow(0);

        // Assume all json objects have the same keys
        var headers = Object.keys(tableJson[0]);

        for (var j = 0; j < headers.length; j++) {
            var cell = document.createElement("th");
            headerRow.appendChild(cell);
            cell.innerHTML = headers[j];

        }

        var tbody = document.createElement('tbody');
        table.appendChild(tbody);

        for (var i = 0; i < tableJson.length; i++) {

            var json = tableJson[i];

            var row = document.createElement("tr");
            row.id = "row_" + i;
            tbody.appendChild(row);

            row.onclick = function (event) {

                console.log(event.target.parentElement.id);
            }

            for (j = 0; j < headers.length; j++) {
                var key = headers[j];
                var value = json[key];

                cell = document.createElement("td");
                cell.rowID = i;
                row.appendChild(cell);
                cell.innerHTML = value;
            }

        }
    }


</script>


</body>